<h1 class="title">Cities weather</h1>
<article class="panel is-primary">
  <div class="panel-heading"><h2>{{cityName$ | async}}</h2></div>
  <div class="panel-block">
    <app-l-map zoom="13" *ngIf="cityCoords$ | async as coords" [lat]="coords.latitude" [long]="coords.longitude"></app-l-map>
  </div>
  <div class="panel-block">
    <div class="control">
      <label class="radio">
        <input type="radio" name="degree" value="C" [(ngModel)]="degree">
        C°
      </label>
      <label class="radio">
        <input type="radio" name="degree" value="F" [(ngModel)]="degree">
        F°
      </label>
    </div>
    <div class="control">
      <label class="radio">
        <input type="radio" name="mode" value="simple" [(ngModel)]="mode">
        Simple
      </label>
      <label class="radio">
        <input type="radio" name="mode" value="detailed" [(ngModel)]="mode">
        Detailed
      </label>
    </div>
  </div>
  <ng-container *ngIf="mode === 'simple'">
    <div class="panel-block" *ngIf="cityWeather$ | async as cityWeather; else loading">
      <table class="table">
        <tr>
          <th>Date</th>
          <th>Weather</th>
          <th>Max</th>
          <th>Min</th>
        </tr>
        <tr *ngFor="let weather of cityWeather">
          <td>{{weather.day | date:'mediumDate'}}</td>
          <td><img [src]="'https://ssl.gstatic.com/onebox/weather/48/'+weather.weather+'.png'" [alt]="weather.weather"></td>
          <td>{{weather.temperatureMax | degree: degree}}</td>
          <td>{{weather.temperatureMin | degree: degree}}</td>
        </tr>
      </table>
    </div>
  </ng-container>
  <ng-container *ngIf="mode === 'detailed'">
    <div class="panel-block" *ngIf="cityWeatherDetailed$ | async as cityWeather; else loading">
      <table class="table">
        <tr>
          <th>Date</th>
          <th>Weather</th>
          <th>Temp</th>
        </tr>
        <tr *ngFor="let weather of cityWeather">
          <td>{{weather.date | date:'MMM d, hh:mm'}}</td>
          <td><img [src]="'https://ssl.gstatic.com/onebox/weather/48/'+weather.weather+'.png'" [alt]="weather.weather"></td>
          <td>{{weather.temperature | degree: degree}}</td>
        </tr>
      </table>
    </div>
  </ng-container>
  <ng-template #loading>
    <div class="panel-block">Loading...</div>
  </ng-template>
  <div class="panel-block">
    <a routerLink="/" class="button is-rounded">
      Go back home
    </a>
  </div>
</article>
